<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@500&display=swap" rel="stylesheet">
    <title>Display Informasi Digital Tjahaja Baru</title>
    <style>
        #slidesFrame {
            width: 100%;
            height: calc(100vh - 50px);
            border: none;
            opacity: 0;
            transition: opacity 1s ease-in-out;
        }

        #loadingScreen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background-color: #ffffff;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            z-index: 1;
            font-family: Arial, sans-serif;
        }

        .loader {
            width: 40px;
            aspect-ratio: 1;
            --c: linear-gradient(#000 0 0);
            --m: radial-gradient(farthest-side,#000 92%,#0000);
            background: 
                var(--c),var(--m),
                var(--c),var(--m), 
                var(--c),var(--m);
            background-size: 8px 12px,8px 8px;
            background-repeat: no-repeat;
            animation: l17 1s infinite linear;
        }

        @keyframes l17 {
            0%,5% {background-position: 0 50%, 0 0, 50% 50%, 50% 0, 100% 50%, 100% 0}
            12.5% {background-position: 0 50%, 0 calc(50% - 10px), 50% 50%, 50% 0, 100% 50%, 100% 0}
            25%   {background-position: 0 calc(50% + 10px), 0 50%, 50% 50%, 50% 0, 100% 50%, 100% 0}
            37.5% {background-position: 0 calc(50% + 10px), 0 50%, 50% 50%, 50% calc(50% - 10px), 100% 50%, 100% 0}
            50%   {background-position: 0 50%, 0 0, 50% 50%, 50% 0, 100% 50%, 100% 0}
            62.5% {background-position: 0 50%, 0 0, 50% calc(50% + 10px), 50% 50%, 100% 50%, 100% calc(50% - 10px)}
            75%   {background-position: 0 50%, 0 0, 50% 50%, 50% 0, 100% calc(50 + 10px), 100% 50%}
            87.5% {background-position: 0 50%, 0 0, 50% 50%, 50% 0, 100% calc(50 + 10px), 100% 50%}
            95%, 100%  {background-position: 0 50%, 0 0, 50% 50%, 50% 0, 100% 50%, 100% 0}
        }

        .title {
            font-weight: bold;
            font-size: 36px;
            color: #041066;
            margin-top: 20px;
        }

        #footer {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: rgba(255, 255, 255, 0.95);
            color: #041066;
            display: flex;
            align-items: center;
            overflow: hidden;
            border-top: 3px solid #041066;
            padding: 5px 0;
            font-family: 'Roboto', sans-serif;
            height: 45px;
            z-index: 999;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
        }

        #timeDisplay {
            padding: 0 20px;
            white-space: nowrap;
            font-weight: bold;
            font-size: 17px;
            background-color: #041066;
            color: white;
            height: 100%;
            display: flex;
            align-items: center;
            min-width: 350px;
        }

        .marquee-container {
            flex: 1;
            overflow: hidden;
            position: relative;
            height: 100%;
        }

        .marquee {
            display: inline-block;
            white-space: nowrap;
            padding-left: 100%;
            font-size: 19px;
            font-weight: 500;
            line-height: 45px;
            animation: scroll-left 35s linear infinite;
        }

        @keyframes scroll-left {
            0% {
                transform: translateX(0);
            }
            100% {
                transform: translateX(-100%);
            }
        }
    </style>
</head>
<body>

    <div id="loadingScreen">
        <div class="loader"></div>
        <div class="title">TJAHAJA BARU</div>
    </div>

    <iframe id="slidesFrame" 
            src="https://docs.google.com/presentation/d/e/2PACX-1vSQ38LjFgAHXbNbfC4gkaOTJsLCCny4BZhxZ3ttF_mD74Onq800eqQhN7pqHnr6fgexDu8dSJv1Fl1d/embed?start=true&loop=true&delayms=30000" 
            allowfullscreen="true">
    </iframe>

    <div id="footer">
        <div id="timeDisplay">00:00:00</div>
        <div class="marquee-container">
            <div id="marqueeText" class="marquee">Memuat informasi...</div>
        </div>
    </div>

    <script>
        // !!! GANTI INI DENGAN URL APPS SCRIPT ANDA !!!
        const API_URL = 'https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec';
        
        const iframe = document.getElementById("slidesFrame");
        const loadingScreen = document.getElementById("loadingScreen");
        const marqueeText = document.getElementById("marqueeText");
        const timeDisplay = document.getElementById("timeDisplay");

        let currentTextIndex = 0;
        let runningTexts = [];

        // Fetch data dari Google Sheets
        async function fetchRunningTexts() {
            try {
                const response = await fetch(API_URL);
                const result = await response.json();
                
                if (result.success && result.data.length > 0) {
                    runningTexts = result.data;
                    console.log('Loaded texts:', runningTexts);
                } else {
                    runningTexts = [{
                        text: 'DISPLAY INFORMASI TJAHAJA BARU',
                        daysRemaining: 999
                    }];
                }
            } catch (error) {
                console.error('Error fetching data:', error);
                runningTexts = [{
                    text: 'DISPLAY INFORMASI TJAHAJA BARU',
                    daysRemaining: 999
                }];
            }
        }

        // Tampilkan teks satu per satu dengan kecepatan optimal untuk usia 40+
        function showNextText() {
            if (runningTexts.length === 0) return;
            
            if (currentTextIndex >= runningTexts.length) {
                currentTextIndex = 0;
            }

            const currentText = runningTexts[currentTextIndex].text;
            const daysLeft = runningTexts[currentTextIndex].daysRemaining;
            
            // Tambah info sisa hari jika kurang dari 3 hari
            let displayText = currentText;
            if (daysLeft <= 3 && daysLeft > 0) {
                displayText += ` (Berakhir ${daysLeft} hari lagi)`;
            }
            
            // Separator motor Yamaha ðŸï¸
            const separator = ' ðŸï¸ ';
            marqueeText.textContent = displayText + separator + displayText + separator + displayText + separator;
            
            // Reset animasi dengan kecepatan yang nyaman dibaca (35 detik per loop)
            marqueeText.style.animation = 'none';
            setTimeout(() => {
                marqueeText.style.animation = 'scroll-left 35s linear infinite';
            }, 10);

            currentTextIndex++;

            // Ganti teks setiap 50 detik (kecepatan baca optimal untuk usia 40+)
            setTimeout(showNextText, 50000);
        }

        // Reload hanya iframe Google Slides
        function reloadSlides() {
            const currentSrc = iframe.src;
            iframe.src = '';
            setTimeout(() => {
                iframe.src = currentSrc;
            }, 100);
        }

        // Update waktu
        function updateTime() {
            const daysOfWeek = ["Minggu", "Senin", "Selasa", "Rabu", "Kamis", "Jumat", "Sabtu"];
            const monthsOfYear = ["Januari", "Februari", "Maret", "April", "Mei", "Juni", "Juli", "Agustus", "September", "Oktober", "November", "Desember"];

            const currentDate = new Date();
            const dayOfWeek = daysOfWeek[currentDate.getDay()];
            const dayOfMonth = currentDate.getDate();
            const month = monthsOfYear[currentDate.getMonth()];
            const year = currentDate.getFullYear();
            const hours = currentDate.getHours().toString().padStart(2, '0');
            const minutes = currentDate.getMinutes().toString().padStart(2, '0');
            const seconds = currentDate.getSeconds().toString().padStart(2, '0');

            timeDisplay.textContent = `${dayOfWeek}, ${dayOfMonth} ${month} ${year} | ${hours}:${minutes}:${seconds}`;
        }

        // Initialize
        setTimeout(() => {
            loadingScreen.style.display = "none";
            iframe.style.opacity = 1;
        }, 3000);

        setInterval(updateTime, 1000);
        updateTime();

        // Load data dan mulai running text
        fetchRunningTexts().then(() => {
            showNextText();
        });

        // Refresh data dari Google Sheets setiap 2 menit
        setInterval(fetchRunningTexts, 120000);

        // Reload Google Slides setiap 60 detik
        setInterval(reloadSlides, 60000);

        console.log('Display sistem aktif - Kecepatan optimal untuk usia 40+ tahun');
    </script>
</body>
</html>
